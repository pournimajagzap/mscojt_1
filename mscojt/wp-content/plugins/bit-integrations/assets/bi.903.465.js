var w=Object.defineProperty;var h=Object.getOwnPropertySymbols;var T=Object.prototype.hasOwnProperty,F=Object.prototype.propertyIsEnumerable;var S=(l,t,r)=>t in l?w(l,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):l[t]=r,P=(l,t)=>{for(var r in t||(t={}))T.call(t,r)&&S(l,r,t[r]);if(h)for(var r of h(t))F.call(t,r)&&S(l,r,t[r]);return l};import{u as R,r as i,j as s}from"./main-390.js";import{e as B,_ as A,I as D,G as E,d as a}from"./bi.126.82.js";import{S as M}from"./bi.348.918.js";import z from"./bi.536.325.js";import{h as Z,c as C}from"./bi.906.898.js";import{P as H}from"./bi.990.899.js";import"./bi.243.742.js";function Y({formFields:l,setFlow:t,flow:r,allIntegURL:p}){const y=R(),[f,c]=i.useState(!1),[m,k]=i.useState({}),[n,g]=i.useState(1),[_,b]=i.useState({show:!1}),x=[{key:"company",label:"Company",required:!0},{key:"vat",label:"VAT Number",required:!1},{key:"phonenumber",label:"Phone Number",required:!1},{key:"website",label:"Website",required:!1},{key:"address",label:"Address",required:!1},{key:"city",label:"City",required:!1},{key:"state",label:"State",required:!1},{key:"zip",label:"Zip",required:!1},{key:"country",label:"Country",required:!1},{key:"billing_street",label:"Billing Street",required:!1},{key:"billing_city",label:"Billing City",required:!1},{key:"billing_state",label:"Billing State",required:!1},{key:"billing_zip",label:"Billing Zip",required:!1},{key:"billing_country",label:"Billing Country",required:!1},{key:"shipping_street",label:"Shipping Street",required:!1},{key:"shipping_city",label:"Shipping City",required:!1},{key:"shipping_state",label:"Shipping State",required:!1},{key:"shipping_zip",label:"Shipping Zip",required:!1},{key:"shipping_country",label:"Shipping Country",required:!1}],N=[{key:"firstname",label:"First Name",required:!0},{key:"lastname",label:"Last Name",required:!0},{key:"email",label:"Email Address",required:!0},{key:"title",label:"Position",required:!1},{key:"phonenumber",label:"Phone Number",required:!1},{key:"password",label:"Password",required:!1}],j=[{key:"name",label:"Name",required:!0},{key:"title",label:"Position",required:!1},{key:"email",label:"Email Address",required:!1},{key:"website",label:"Website",required:!1},{key:"phonenumber",label:"Phone Number",required:!1},{key:"company",label:"Company",required:!1},{key:"address",label:"Address",required:!1},{key:"city",label:"City",required:!1},{key:"state",label:"State",required:!1},{key:"zip",label:"Zip",required:!1},{key:"country",label:"Country",required:!1},{key:"description",label:"Description",required:!1},{key:"custom_contact_date",label:"Date Contacted",required:!1}],v=[{key:"name",label:"Name",required:!0},{key:"start_date",label:"Start Date",required:!0},{key:"deadline",label:"Dead Line",required:!1},{key:"project_cost ",label:"project Cost",required:!1},{key:"estimated_hours",label:"Estimated Hours",required:!1},{key:"description",label:"Project Description",required:!1}],[e,d]=i.useState({name:"PerfexCRM",type:"PerfexCRM",api_token:"",domain:"",field_map:[{formField:"",perfexCRMFormField:""}],actionName:"",selectedLeadSourceId:1,selectedLeadStatusId:1,actionId:"",customerFields:x,contactFields:N,leadFields:j,projectFields:v,actions:{}}),I=()=>{c(!0),E(r,t,p,e,y,"","",c).then(u=>{var q;u.success?(a.success((q=u.data)==null?void 0:q.msg),y(p)):a.error(u.data||u)})},L=o=>{if(setTimeout(()=>{document.getElementById("btcd-settings-wrp").scrollTop=0},300),!C(e)){a.error("Please map mandatory fields");return}if(e.actionName==="contact"&&!e.selectedCustomer){a.error("Please select a Customer");return}if(e.actionName==="lead"&&(!e.selectedLeadStatusId||!e.selectedLeadSourceId)){a.error("Lead Status Id and Lead Source Id are required!");return}if(e.actionName==="project"){if(!e.selectedProjectStatus){a.error("Please select Project status");return}if(!e.selectedProjectType){a.error("Please select Project Related With...");return}if(!e.selectedbillingType){a.error("Please select a Billing type");return}if(!e.selectedCustomer){a.error("Please select a Customer");return}if(Number(e.selectedbillingType)===1&&!e.totalRate){a.error("Please select a Total Rate");return}if(Number(e.selectedbillingType)===2&&!e.ratePerHour){a.error("Please select a Rate Per Hour");return}}e.field_map.length>0&&g(o)};return s.jsxs("div",{children:[s.jsx(B,{snack:_,setSnackbar:b}),s.jsx("div",{className:"txt-center mt-2",children:s.jsx(M,{step:3,active:n})}),s.jsx(z,{perfexCRMConf:e,setPerfexCRMConf:d,step:n,setStep:g,loading:m,setLoading:k,setSnackbar:b}),s.jsxs("div",{className:"btcd-stp-page",style:P({},n===2&&{width:900,height:"auto",overflow:"visible"}),children:[s.jsx(H,{formFields:l,handleInput:o=>Z(o,e,d),perfexCRMConf:e,setPerfexCRMConf:d,loading:m,setLoading:k,isLoading:f,setIsLoading:c,setSnackbar:b}),(e==null?void 0:e.actionName)&&s.jsxs("button",{onClick:()=>L(3),disabled:!C(e),className:"btn f-right btcd-btn-lg green sh-sm flx",type:"button",children:[A("Next","bit-integrations")," ","Â ",s.jsx("div",{className:"btcd-icn icn-arrow_back rev-icn d-in-b"})]})]}),(e==null?void 0:e.actionName)&&s.jsx(D,{step:n,saveConfig:()=>I(),isLoading:f,dataConf:e,setDataConf:d,formFields:l})]})}export{Y as default};
