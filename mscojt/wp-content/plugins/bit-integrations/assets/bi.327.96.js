var z=Object.defineProperty;var k=Object.getOwnPropertySymbols;var B=Object.prototype.hasOwnProperty,H=Object.prototype.propertyIsEnumerable;var I=(c,d,o)=>d in c?z(c,d,{enumerable:!0,configurable:!0,writable:!0,value:o}):c[d]=o,b=(c,d)=>{for(var o in d||(d={}))B.call(d,o)&&I(c,o,d[o]);if(k)for(var o of k(d))H.call(d,o)&&I(c,o,d[o]);return c};import{r as m,d as $,h as J,k as K,u as Q,j as e}from"./main-390.js";import{h as V,$ as W,i as X,c as j,e as Y,k as n,j as Z,I as ee,s as te}from"./bi.126.82.js";import{p as se}from"./bi.137.717.js";import{P as f,a as v,c as ie,b as ae}from"./bi.729.718.js";import"./bi.286.689.js";import"./bi.414.690.js";function re({allIntegURL:c}){var N,y,P;const[d,o]=m.useState([]),[M,T]=m.useState([]),[s,p]=$(V),[g,O]=$(W),h=J(X);m.useState([]),K();const E=Q(),[D,_]=m.useState([]),[A,F]=m.useState([]),[q,r]=m.useState({show:!1}),[L,R]=m.useState(!1);m.useEffect(()=>{j({},"pods/list",null,"GET").then(t=>{var i,l;t!=null&&t.success&&t!==void 0&&(o(Object.values((i=t.data)==null?void 0:i.post_types)),T((l=t.data)==null?void 0:l.users))}),j({post_type:s==null?void 0:s.post_type},"pods/fields").then(t=>{var i,l;t!=null&&t.success&&t!==void 0&&(_(Object.values((i=t==null?void 0:t.data)==null?void 0:i.podFields)),F(Object.values((l=t==null?void 0:t.data)==null?void 0:l.podFiles)))})},[]);const u=(t,i,l)=>{const a=b({},s);l?a[t]=Number(i):a[t]=i,p(a)},U=(t,i)=>{const l=b({},s);l[t]=i,j({post_type:i},"pods/fields").then(a=>{var C,S,w;a!=null&&a.success&&a!==void 0&&(_(Object.values((C=a==null?void 0:a.data)==null?void 0:C.podFields)),F(Object.values((S=a==null?void 0:a.data)==null?void 0:S.podFiles)),a!=null&&a.data&&(l.pod_map=Object.values(a.data).filter(x=>x.required).map(x=>({formField:"",podField:x.key,required:x.required})),((w=l==null?void 0:l.pod_map)==null?void 0:w.length)<1&&(l.pod_map=[{}])),p(l))})},G=()=>{if(!ie(s)){r({show:!0,msg:n("Please map mandatory fields","bit-integrations")});return}if(!ae(s)){r({show:!0,msg:n("Please map mandatory fields","bit-integrations")});return}te({flow:g,setFlow:O,allIntegURL:c,conf:s,navigate:E,edit:1,setIsLoading:R,setSnackbar:r})};return e.jsxs("div",{style:{width:900},children:[e.jsx(Y,{snack:q,setSnackbar:r}),e.jsx("div",{className:"mt-3",children:e.jsx("b",{children:n("Integration Name ","bit-integrations")})}),e.jsx("input",{className:"btcd-paper-inp w-5 mt-1",onChange:t=>u(t.target.name,t.target.value),name:"name",value:s.name,type:"text",placeholder:n("Integration Name...","bit-integrations")}),e.jsx("br",{}),e.jsx("br",{}),e.jsx(Z,{entity:g.triggered_entity,setSnackbar:r}),e.jsx("div",{className:"mt-3",children:e.jsx("b",{children:n("Post Type","bit-integrations")})}),e.jsxs("select",{name:"post_type",onChange:t=>U(t.target.name,t.target.value),value:s==null?void 0:s.post_type,className:"btcd-paper-inp w-5 mt-1",children:[e.jsx("option",{disabled:!0,selected:!0,children:"Select Type"}),d.map((t,i)=>e.jsx("option",{value:t.name,children:t.label},`pod-${i*2}`))]}),e.jsx("div",{className:"mt-3",children:e.jsx("b",{children:n("Post Status","bit-integrations")})}),e.jsxs("select",{name:"post_status",onChange:t=>u(t.target.name,t.target.value),value:s==null?void 0:s.post_status,className:"btcd-paper-inp w-5 mt-1",children:[e.jsx("option",{disabled:!0,selected:!0,children:n("Select Status","bit-integrations")}),e.jsx("option",{value:"publish",children:"Publish"}),e.jsx("option",{value:"draft",children:"Draft"}),e.jsx("option",{value:"inherit",children:"Inherit"}),e.jsx("option",{value:"auto-draft",children:"Auto-Draft"}),e.jsx("option",{value:"private ",children:"Private"}),e.jsx("option",{value:"pending",children:"Pending"})]}),e.jsx("div",{className:"mt-3",children:e.jsx("b",{children:n("Comment Status","bit-integrations")})}),e.jsxs("select",{name:"comment_status",onChange:t=>u(t.target.name,t.target.value),value:s==null?void 0:s.comment_status,className:"btcd-paper-inp w-5 mt-1",children:[e.jsx("option",{disabled:!0,selected:!0,children:n("Select Status","bit-integrations")}),e.jsx("option",{value:"open",children:"Open"}),e.jsx("option",{value:"closed",children:"Closed"})]}),e.jsx("div",{className:"mt-3",children:e.jsx("b",{children:n("Author","bit-integrations")})}),e.jsxs("select",{name:"post_author",onChange:t=>u(t.target.name,t.target.value),value:s==null?void 0:s.post_author,className:"btcd-paper-inp w-5 mt-1",children:[e.jsx("option",{disabled:!0,selected:!0,children:n("Select Author","bit-integrations")}),e.jsx("option",{value:"logged_in_user",children:"Logged In User"}),M.map((t,i)=>e.jsx("option",{value:t.ID,children:t.display_name},`pod-${i*2}`))]}),e.jsxs("div",{children:[e.jsxs("div",{children:[e.jsx("div",{className:"mt-3 mb-1",children:e.jsx("b",{children:"Post Fields Mapping"})}),e.jsx("div",{className:"btcd-hr"}),e.jsxs("div",{className:"flx flx-around mt-2 mb-2 btcbi-field-map-label",children:[e.jsx("div",{className:"txt-dp",children:e.jsx("b",{children:n("Form Fields","bit-integrations")})}),e.jsx("div",{className:"txt-dp",children:e.jsx("b",{children:n("Post Fields","bit-integrations")})})]})]}),(N=s==null?void 0:s.post_map)==null?void 0:N.map((t,i)=>e.jsx(f,{i,type:"post",field:t,formFields:h,podsConf:s,setPodsConf:p,podFields:se,fieldType:"fields"},`analytics-m-${i+9}`)),e.jsx("div",{className:"txt-center btcbi-field-map-button mt-2",children:e.jsx("button",{onClick:()=>v("post_map",s.post_map.length,s,p),className:"icn-btn sh-sm",type:"button",children:"+"})}),e.jsxs("div",{children:[e.jsx("div",{className:"mt-3 mb-1",children:e.jsx("b",{children:"Pod Fields Mapping"})}),e.jsx("div",{className:"btcd-hr"}),e.jsxs("div",{className:"flx flx-around mt-2 mb-2 btcbi-field-map-label",children:[e.jsx("div",{className:"txt-dp",children:e.jsx("b",{children:n("Form Fields","bit-integrations")})}),e.jsx("div",{className:"txt-dp",children:e.jsx("b",{children:n("Pod Fields","bit-integrations")})})]})]}),(y=s==null?void 0:s.pod_field_map)==null?void 0:y.map((t,i)=>e.jsx(f,{i,type:"pod",field:t,formFields:h,podsConf:s,setPodsConf:p,podFields:D,fieldType:"fields"},`analytics-m-${i+9}`)),e.jsx("div",{className:"txt-center btcbi-field-map-button mt-2",children:e.jsx("button",{onClick:()=>v("pod_field_map",s.pod_field_map.length,s,p),className:"icn-btn sh-sm",type:"button",children:"+"})}),e.jsxs("div",{children:[e.jsx("div",{className:"mt-3 mb-1",children:e.jsx("b",{children:"Pod File Upload Mapping"})}),e.jsx("div",{className:"btcd-hr"}),e.jsxs("div",{className:"flx flx-around mt-2 mb-2 btcbi-field-map-label",children:[e.jsx("div",{className:"txt-dp",children:e.jsx("b",{children:n("Form Fields","bit-integrations")})}),e.jsx("div",{className:"txt-dp",children:e.jsx("b",{children:n("Pod Fields","bit-integrations")})})]})]}),(P=s==null?void 0:s.pod_file_map)==null?void 0:P.map((t,i)=>e.jsx(f,{i,type:"podFile",field:t,formFields:h,podsConf:s,setPodsConf:p,podFields:A,fieldType:"file"},`analytics-m-${i+9}`)),e.jsx("div",{className:"txt-center btcbi-field-map-button mt-2",children:e.jsx("button",{onClick:()=>v("pod_file_map",s.pod_file_map.length,s,p),className:"icn-btn sh-sm",type:"button",children:"+"})})]}),e.jsx(ee,{edit:!0,saveConfig:G,isLoading:L,dataConf:s,setDataConf:p,formFields:h})]})}export{re as default};
