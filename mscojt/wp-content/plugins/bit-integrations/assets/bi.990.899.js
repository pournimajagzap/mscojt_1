var J=Object.defineProperty;var D=Object.getOwnPropertySymbols;var W=Object.prototype.hasOwnProperty,z=Object.prototype.propertyIsEnumerable;var E=(e,d,s)=>d in e?J(e,d,{enumerable:!0,configurable:!0,writable:!0,value:s}):e[d]=s,h=(e,d)=>{for(var s in d||(d={}))W.call(d,s)&&E(e,s,d[s]);if(D)for(var s of D(d))z.call(d,s)&&E(e,s,d[s]);return e};import{r as Q,j as t,L as U,h as X}from"./main-390.js";import{o as w,_ as a,f as I,p as P,J as Y,l as Z,m as x,B as M}from"./bi.126.82.js";import{g as q,a as k,r as B,b as R}from"./bi.906.898.js";const K=(e,d,s)=>{const i=h({},d);i.field_map.splice(e,0,{}),s(h({},i))},f=(e,d,s)=>{const i=h({},d);i.field_map.length>1&&i.field_map.splice(e,1),s(h({},i))},G=(e,d,s,i)=>{const n=h({},s);n.field_map[d][e.target.name]=e.target.value,e.target.value==="custom"&&(n.field_map[d].customValue=""),e.target.value==="customFieldKey"&&(n.field_map[d].customFieldKey=""),i(h({},n))},C=(e,d,s,i,n)=>{const o=h({},s);o.field_map[d][n]=e.target.value,i(h({},o))};function tt({perfexCRMConf:e,setPerfexCRMConf:d,loading:s,setLoading:i}){var S,m,y,T,c,N,j,F;const[n,o]=Q.useState({show:!1,action:()=>{}}),b=(l,v)=>{var A,p,_,O,L,V,$,H;const r=h({},e);v==="direction"?(A=l.target)!=null&&A.checked?r.actions.direction=!0:(o({show:!1}),delete r.actions.direction):v==="contactIsPrimary"?(p=l.target)!=null&&p.checked?r.actions.contactIsPrimary=!0:delete r.actions.contactIsPrimary:v==="permission"?(_=l.target)!=null&&_.checked?(r.permissions=[{id:1,name:"Invoices permission"},{id:2,name:"Estimates permission"},{id:3,name:"Contracts permission"},{id:4,name:"Proposals permission"},{id:5,name:"Support permission"},{id:6,name:"Projects permission"}],r.actions.permission=!0):(o({show:!1}),delete r.actions.permission):v==="leadIsPublic"?(O=l.target)!=null&&O.checked?r.actions.leadIsPublic=!0:delete r.actions.leadIsPublic:v==="contactedToday"?(L=l.target)!=null&&L.checked?r.actions.contactedToday=!0:delete r.actions.contactedToday:v==="leadStatus"?(V=l.target)!=null&&V.checked?r.actions.leadStatus=!0:delete r.actions.leadStatus:v==="leadSource"?($=l.target)!=null&&$.checked?r.actions.leadSource=!0:delete r.actions.leadSource:v==="projectMembers"&&((H=l.target)!=null&&H.checked?(q(r,d,s,i),r.actions.projectMembers=!0):delete r.actions.projectMembers),o({show:v}),d(h({},r))},u=()=>{o({show:!1})},g=(l,v)=>{const r=h({},e);r[v]=l,d(h({},r))};return t.jsxs("div",{className:"pos-rel d-flx flx-wrp",children:[e.actionName==="contact"&&t.jsx(w,{checked:(e==null?void 0:e.selectedDirection)||!1,onChange:l=>b(l,"direction"),className:"wdt-200 mt-4 mr-2",value:"direction",title:a("Add Direction","bit - integrations"),subTitle:a("Add Direction")}),e.actionName==="contact"&&t.jsx(w,{checked:((S=e==null?void 0:e.selectedPermission)==null?void 0:S.length)||!1,onChange:l=>b(l,"permission"),className:"wdt-200 mt-4 mr-2",value:"permission",title:a("Add Permissions","bit - integrations"),subTitle:a("Add Permissions for this contact")}),e.actionName==="contact"&&t.jsx(w,{checked:((m=e.actions)==null?void 0:m.contactIsPrimary)||!1,onChange:l=>b(l,"contactIsPrimary"),className:"wdt-200 mt-4 mr-2",value:"contactIsPrimary",title:a("Is it Primary Contact?","bit-integrations"),subTitle:a("Is it Primary Contact?","bit-integrations")}),e.actionName==="lead"&&t.jsx(w,{checked:((y=e.actions)==null?void 0:y.leadIsPublic)||!1,onChange:l=>b(l,"leadIsPublic"),className:"wdt-200 mt-4 mr-2",value:"leadIsPublic",title:a("Public","bit-integrations"),subTitle:a("Is it Public?","bit-integrations")}),e.actionName==="lead"&&t.jsx(w,{checked:((T=e.actions)==null?void 0:T.contactedToday)||!1,onChange:l=>b(l,"contactedToday"),className:"wdt-200 mt-4 mr-2",value:"contactedToday",title:a("Contacted Today","bit-integrations"),subTitle:a("Contacted Today","bit-integrations")}),e.actionName==="lead"&&t.jsx(w,{checked:((c=e.actions)==null?void 0:c.leadStatus)||!1,onChange:l=>b(l,"leadStatus"),className:"wdt-200 mt-4 mr-2",value:"leadStatus",title:a("Add Lead Status Id","bit-integrations"),subTitle:a("Add Lead Status Id","bit-integrations")}),e.actionName==="lead"&&t.jsx(w,{checked:((N=e.actions)==null?void 0:N.leadSource)||!1,onChange:l=>b(l,"leadSource"),className:"wdt-200 mt-4 mr-2",value:"leadSource",title:a("Add Lead Source Id","bit-integrations"),subTitle:a("Add Lead Source Id","bit-integrations")}),e.actionName==="project"&&t.jsx(w,{checked:(e==null?void 0:e.selectedProjectMembers)||!1,onChange:l=>b(l,"projectMembers"),className:"wdt-200 mt-4 mr-2",value:"projectMembers",title:a("Add Project Members","bit-integrations"),subTitle:a("Add Project Members","bit-integrations")}),t.jsxs(I,{className:"custom-conf-mdl",mainMdlCls:"o-v",btnClass:"blue",btnTxt:a("Ok","bit-integrations"),show:n.show==="direction",close:u,action:u,title:a("Direction","bit-integrations"),children:[t.jsx("div",{className:"btcd-hr mt-2 mb-2"}),t.jsx("div",{className:"mt-2",children:a("Select Direction","bit-integrations")}),t.jsx("div",{className:"flx flx-between mt-2",children:t.jsx(P,{options:["rtl","ltr"].map(l=>({label:l,value:l})),className:"msl-wrp-options",defaultValue:e==null?void 0:e.selectedDirection,onChange:l=>g(l,"selectedDirection"),singleSelect:!0,closeOnSelect:!0})})]}),t.jsxs(I,{className:"custom-conf-mdl",mainMdlCls:"o-v",btnClass:"blue",btnTxt:a("Ok","bit-integrations"),show:n.show==="leadStatus",close:u,action:u,title:a("Add Lead Status Id","bit-integrations"),children:[t.jsx("div",{className:"btcd-hr mt-2 mb-2"}),t.jsxs("div",{className:"flx",children:[t.jsx("b",{className:"wdt-200 d-in-b",children:a("Lead Status Id:","bit-integrations")}),t.jsx("input",{className:"btcd-paper-inp w-5 mt-1",onChange:l=>g(l.target.value,"selectedLeadStatusId"),name:"selectedLeadStatusId",value:(e==null?void 0:e.selectedLeadStatusId)||"",type:"number",placeholder:a("Lead Status Id...","bit-integrations")}),t.jsx("span",{className:"icn-btn sh-sm ml-2 mr-2 tooltip info-view mt-1",style:{"--tooltip-txt":`'${a('Go to PerfexCRM Admin area & select the following menu: "SETUP → Leads → Statuses".',"bit-integrations")}'`},children:"!"})]})]}),t.jsxs(I,{className:"custom-conf-mdl",mainMdlCls:"o-v",btnClass:"blue",btnTxt:a("Ok","bit-integrations"),show:n.show==="leadSource",close:u,action:u,title:a("Add Lead Source Id","bit-integrations"),children:[t.jsx("div",{className:"btcd-hr mt-2 mb-2"}),t.jsxs("div",{className:"flx",children:[t.jsx("b",{className:"wdt-200 d-in-b",children:a("Lead Source Id:","bit-integrations")}),t.jsx("input",{className:"btcd-paper-inp w-5 mt-1",onChange:l=>g(l.target.value,"selectedLeadSourceId"),name:"selectedLeadSourceId",value:(e==null?void 0:e.selectedLeadSourceId)||"",type:"number",placeholder:a("Lead Source Id...","bit-integrations")}),t.jsx("span",{className:"icn-btn sh-sm ml-2 mr-2 tooltip info-view mt-1",style:{"--tooltip-txt":`'${a('Go to PerfexCRM Admin area & select the following menu: "SETUP → Leads → Sources".',"bit-integrations")}'`},children:"!"})]})]}),t.jsxs(I,{className:"custom-conf-mdl",mainMdlCls:"o-v",btnClass:"blue",btnTxt:a("Ok","bit-integrations"),show:n.show==="permission",close:u,action:u,title:a("Add Permission","bit-integrations"),children:[t.jsx("div",{className:"btcd-hr mt-2 mb-2"}),t.jsx("div",{className:"mt-2",children:a("Select Permission","bit-integrations")}),t.jsx("div",{className:"flx flx-between mt-2",children:t.jsx(P,{options:(j=e==null?void 0:e.permissions)==null?void 0:j.map(l=>({label:l.name,value:l.id.toString()})),className:"msl-wrp-options",defaultValue:e==null?void 0:e.selectedPermission,onChange:l=>g(l,"selectedPermission")})})]}),t.jsxs(I,{className:"custom-conf-mdl",mainMdlCls:"o-v",btnClass:"blue",btnTxt:a("Ok","bit-integrations"),show:n.show==="projectMembers",close:u,action:u,title:a("Add Project Members","bit-integrations"),children:[t.jsx("div",{className:"btcd-hr mt-2 mb-2"}),t.jsx("div",{className:"mt-2",children:a("Select Project Member","bit-integrations")}),s.staffs?t.jsx(U,{style:{display:"flex",justifyContent:"center",alignItems:"center",height:45,transform:"scale(0.5)"}}):t.jsxs("div",{className:"flx flx-between mt-2",children:[t.jsx(P,{options:(F=e==null?void 0:e.staffs)==null?void 0:F.map(l=>({label:l.name,value:l.id.toString()})),className:"msl-wrp-options",defaultValue:e==null?void 0:e.selectedProjectMembers,onChange:l=>g(l,"selectedProjectMembers")}),t.jsx("button",{onClick:()=>q(e,d,s,i),className:"icn-btn sh-sm ml-2 mr-2 tooltip",style:{"--tooltip-txt":`${a("Refresh Project Members","bit-integrations")}'`},type:"button",children:"↻"})]})]})]})}function st({field:e,index:d,conf:s,setConf:i,fieldValue:n,fieldLabel:o,className:b}){return t.jsx(Y,{onChange:u=>C(u,d,s,i,n),label:a(o,"bit-integrations"),className:b,type:"text",value:e[n],placeholder:a(o,"bit-integrations")})}function et({i:e,formFields:d,field:s,perfexCRMConf:i,setPerfexCRMConf:n}){var S;const o=(i==null?void 0:i.perfexCRMFields)&&(i==null?void 0:i.perfexCRMFields.filter(m=>m.required===!0))||[],b=(i==null?void 0:i.perfexCRMFields)&&(i==null?void 0:i.perfexCRMFields.filter(m=>m.required===!1))||[],u=X(Z),{isPro:g}=u;return t.jsx("div",{className:"flx mt-2 mb-2 btcbi-field-map",children:t.jsxs("div",{className:"pos-rel flx",children:[t.jsxs("div",{className:"flx integ-fld-wrp",children:[t.jsxs("select",{className:"btcd-paper-inp mr-2",name:"formField",value:s.formField||"",onChange:m=>G(m,e,i,n),children:[t.jsx("option",{value:"",children:a("Select Field","bit-integrations")}),t.jsx("optgroup",{label:"Form Fields",children:d==null?void 0:d.map(m=>t.jsx("option",{value:m.name,children:m.label},`ff-rm-${m.name}`))}),t.jsx("option",{value:"custom",children:a("Custom...","bit-integrations")}),t.jsx("optgroup",{label:`General Smart Codes ${g?"":"(PRO)"}`,children:g&&((S=x)==null?void 0:S.map(m=>t.jsx("option",{value:m.name,children:m.label},`ff-rm-${m.name}`)))})]}),s.formField==="custom"&&t.jsx(st,{field:s,index:e,conf:i,setConf:n,fieldValue:"customValue",fieldLabel:"Custom Value",className:"mr-2"}),t.jsxs("select",{className:"btcd-paper-inp",disabled:e<o.length,name:"perfexCRMFormField",value:e<o.length?o[e].key||"":s.perfexCRMFormField||"",onChange:m=>G(m,e,i,n),children:[t.jsx("option",{value:"",children:a("Select Field","bit-integrations")}),e<o.length?t.jsx("option",{value:o[e].key,children:o[e].label},o[e].key):b.map(({key:m,label:y})=>t.jsx("option",{value:m,children:y},m))]})]}),e>=o.length&&t.jsxs(t.Fragment,{children:[t.jsx("button",{onClick:()=>K(e,i,n),className:"icn-btn sh-sm ml-2 mr-1",type:"button",children:"+"}),t.jsx("button",{onClick:()=>f(e,i,n),className:"icn-btn sh-sm ml-1",type:"button","aria-label":"btn",children:t.jsx("span",{className:"btcd-icn icn-trash-2"})})]})]})})}function dt({formFields:e,handleInput:d,perfexCRMConf:s,setPerfexCRMConf:i,loading:n,setLoading:o,isLoading:b,setIsLoading:u,setSnackbar:g}){var y,T;const S=c=>{i(N=>M(N,j=>{const{name:F}=c.target;c.target.value!==""?(j.actionName=c.target.value,(c.target.value==="contact"||c.target.value==="lead")&&k(j,i,n,o),c.target.value==="project"&&(j.billingTypes=[{id:1,name:"Fixed Rate"},{id:2,name:"Project Hours"},{id:3,name:"Task Hours"}],j.projectStatus=[{id:2,name:"In Progress"},{id:3,name:"On Hold"},{id:4,name:"Finished"},{id:5,name:"Cancelled"}]),B(j,i,u,g)):(delete j[F],delete j.actionId)}))},m=(c,N)=>{const j=h({},s);j[N]=c,N==="selectedProjectType"&&c==="customer"?k(s,i,n,o):N==="selectedProjectType"&&c==="lead"&&R(s,i,n,o),i(h({},j))};return t.jsxs(t.Fragment,{children:[t.jsx("br",{}),t.jsx("b",{className:"wdt-200 d-in-b",children:a("Select Action:","bit-integrations")}),t.jsxs("select",{onChange:S,name:"actionName",value:s.actionName,className:"btcd-paper-inp w-5",children:[t.jsx("option",{value:"",children:a("Select an action","bit-integrations")}),t.jsx("option",{value:"customer","data-action_name":"customer",children:a("Create Customer","bit-integrations")}),t.jsx("option",{value:"contact","data-action_name":"contact",children:a("Create Contact","bit-integrations")}),t.jsx("option",{value:"lead","data-action_name":"lead",children:a("Create Lead","bit-integrations")}),t.jsx("option",{value:"project","data-action_name":"project",children:a("Create project","bit-integrations")})]}),t.jsx("br",{}),t.jsx("br",{}),s.actionName==="project"&&t.jsxs(t.Fragment,{children:[t.jsx("br",{}),t.jsx("br",{}),t.jsxs("div",{className:"flx",children:[t.jsx("b",{className:"wdt-200 d-in-b",children:a("Project Status:","bit-integrations")}),t.jsx(P,{options:s==null?void 0:s.projectStatus.map(c=>({label:c.name,value:c.id.toString()})),className:"msl-wrp-options dropdown-custom-width",defaultValue:s==null?void 0:s.selectedProjectStatus,onChange:c=>m(c,"selectedProjectStatus"),disabled:b,singleSelect:!0,closeOnSelect:!0})]})]}),s.actionName==="project"&&t.jsxs(t.Fragment,{children:[t.jsx("br",{}),t.jsx("br",{}),t.jsx("br",{}),t.jsxs("div",{className:"flx",children:[t.jsx("b",{className:"wdt-200 d-in-b",children:a("Project Related With:","bit-integrations")}),t.jsx(P,{options:["customer","lead"].map(c=>({label:c.charAt(0).toUpperCase()+c.slice(1),value:c})),className:"msl-wrp-options dropdown-custom-width",defaultValue:s==null?void 0:s.selectedProjectType,onChange:c=>m(c,"selectedProjectType"),disabled:b,singleSelect:!0,closeOnSelect:!0})]})]}),(s.actionName==="contact"||s.actionName==="lead"||s.actionName==="project")&&(s==null?void 0:s.customers)&&!n.customers&&t.jsxs(t.Fragment,{children:[t.jsx("br",{}),t.jsxs("div",{className:"flx",children:[t.jsx("b",{className:"wdt-200 d-in-b",children:a("Select Customer:","bit-integrations")}),t.jsx(P,{options:(y=s==null?void 0:s.customers)==null?void 0:y.map(c=>({label:c.name,value:c.id.toString()})),className:"msl-wrp-options dropdown-custom-width",defaultValue:s==null?void 0:s.selectedCustomer,onChange:c=>m(c,"selectedCustomer"),disabled:n.customers,singleSelect:!0,closeOnSelect:!0}),t.jsx("button",{onClick:()=>k(s,i,n,o),className:"icn-btn sh-sm ml-2 mr-2 tooltip",style:{"--tooltip-txt":`'${a("Refresh Customers","bit-integrations")}'`},type:"button",disabled:n.customers,children:"↻"})]})]}),s.actionName==="project"&&(s==null?void 0:s.billingTypes)&&t.jsxs(t.Fragment,{children:[t.jsx("br",{}),t.jsx("br",{}),t.jsx("br",{}),t.jsxs("div",{className:"flx",children:[t.jsx("b",{className:"wdt-200 d-in-b",children:a("Select Billing Type:","bit-integrations")}),t.jsx(P,{options:(T=s==null?void 0:s.billingTypes)==null?void 0:T.map(c=>({label:c.name,value:c.id.toString()})),className:"msl-wrp-options dropdown-custom-width",defaultValue:s==null?void 0:s.selectedbillingType,onChange:c=>m(c,"selectedbillingType"),disabled:b,singleSelect:!0,closeOnSelect:!0})]})]}),s.actionName==="project"&&(s==null?void 0:s.selectedbillingType)==="1"&&t.jsxs(t.Fragment,{children:[t.jsx("br",{}),t.jsxs("div",{className:"flx",children:[t.jsx("b",{className:"wdt-200 d-in-b",children:a("Total Rate:","bit-integrations")}),t.jsx("input",{className:"btcd-paper-inp w-5 mt-1",onChange:c=>m(c.target.value,"totalRate"),name:"totalRate",value:s.totalRate||" ",type:"text",placeholder:a("Total Rate...","bit-integrations"),disabled:b})]})]}),s.actionName==="project"&&(s==null?void 0:s.selectedbillingType)==="2"&&t.jsxs(t.Fragment,{children:[t.jsx("br",{}),t.jsxs("div",{className:"flx",children:[t.jsx("b",{className:"wdt-200 d-in-b",children:a("Rate Per Hour:","bit-integrations")}),t.jsx("input",{className:"btcd-paper-inp w-5 mt-1",onChange:c=>m(c.target.value,"ratePerHour"),name:"ratePerHour",value:s.ratePerHour||" ",type:"text",placeholder:a("Rate Per Hour...","bit-integrations"),disabled:b})]})]}),(b||n.customers||n.leads)&&t.jsx(U,{style:{display:"flex",justifyContent:"center",alignItems:"center",height:100,transform:"scale(0.7)"}}),s.actionName&&!b&&t.jsxs("div",{children:[t.jsx("br",{}),t.jsxs("div",{className:"mt-5",children:[t.jsx("b",{className:"wdt-100",children:a("Field Map","bit-integrations")}),t.jsx("button",{onClick:()=>B(s,i,u,g),className:"icn-btn sh-sm ml-2 mr-2 tooltip",style:{"--tooltip-txt":`'${a("Refresh Custom Fields","bit-integrations")}'`},type:"button",disabled:b,children:"↻"})]}),t.jsx("br",{}),t.jsx("div",{className:"btcd-hr mt-1"}),t.jsxs("div",{className:"flx flx-around mt-2 mb-2 btcbi-field-map-label",children:[t.jsx("div",{className:"txt-dp",children:t.jsx("b",{children:a("Form Fields","bit-integrations")})}),t.jsx("div",{className:"txt-dp",children:t.jsx("b",{children:a("PerfexCRM Fields","bit-integrations")})})]}),s==null?void 0:s.field_map.map((c,N)=>t.jsx(et,{i:N,field:c,perfexCRMConf:s,formFields:e,setPerfexCRMConf:i,setSnackbar:g},`rp-m-${N+9}`)),t.jsx("div",{className:"txt-center btcbi-field-map-button mt-2",children:t.jsx("button",{onClick:()=>K(s.field_map.length,s,i),className:"icn-btn sh-sm",type:"button",children:"+"})}),t.jsx("br",{}),t.jsx("br",{}),t.jsx("div",{className:"mt-4",children:t.jsx("b",{className:"wdt-100",children:a("Actions","bit-integrations")})}),t.jsx("div",{className:"btcd-hr mt-1"}),t.jsx(tt,{perfexCRMConf:s,setPerfexCRMConf:i,formFields:e,loading:n,setLoading:o})]})]})}export{dt as P};
