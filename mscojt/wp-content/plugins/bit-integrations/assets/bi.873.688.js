var M=Object.defineProperty;var N=Object.getOwnPropertySymbols;var T=Object.prototype.hasOwnProperty,V=Object.prototype.propertyIsEnumerable;var _=(t,i,s)=>i in t?M(t,i,{enumerable:!0,configurable:!0,writable:!0,value:s}):t[i]=s,u=(t,i)=>{for(var s in i||(i={}))T.call(i,s)&&_(t,s,i[s]);if(N)for(var s of N(i))V.call(i,s)&&_(t,s,i[s]);return t};import{h as k,j as e,r as j,L as y}from"./main-390.js";import{l as A,_ as r,m as E,n as R,o as $,f as L,p as F}from"./bi.126.82.js";import{g as q}from"./bi.588.687.js";import{T as I}from"./bi.286.689.js";const f=(t,i,s)=>{const l=u({},i);l.field_map.splice(t,0,{}),s(u({},l))},P=(t,i,s)=>{const l=u({},i);l.field_map.length>1&&l.field_map.splice(t,1),s(u({},l))},w=(t,i,s,l)=>{const n=u({},s);n.field_map[i][t.target.name]=t.target.value,t.target.value==="custom"&&(n.field_map[i].customValue=""),l(u({},n))};function U({i:t,formFields:i,field:s,omniSendConf:l,setOmniSendConf:n}){var o,c;if(((o=l==null?void 0:l.field_map)==null?void 0:o.length)===1&&s.omniSendFormField===""){const a=u({},l),d=q(a);a.field_map=d}const b=(l==null?void 0:l.omniSend_fields.filter(a=>a.required===!0))||[],x=(l==null?void 0:l.omniSend_fields.filter(a=>a.required===!1))||[],p=k(A),{isPro:m}=p;return e.jsx("div",{className:"flx mt-2 mb-2 btcbi-field-map",children:e.jsxs("div",{className:"pos-rel flx",children:[e.jsxs("div",{className:"flx integ-fld-wrp",children:[e.jsxs("select",{className:"btcd-paper-inp mr-2",name:"formField",value:s.formField||"",onChange:a=>w(a,t,l,n),children:[e.jsx("option",{value:"",children:r("Select Field","bit-integrations")}),e.jsx("optgroup",{label:"Form Fields",children:i==null?void 0:i.map(a=>e.jsx("option",{value:a.name,children:a.label},`ff-rm-${a.name}`))}),e.jsx("option",{value:"custom",children:r("Custom...","bit-integrations")}),e.jsx("optgroup",{label:`General Smart Codes ${m?"":"(PRO)"}`,children:m&&((c=E)==null?void 0:c.map(a=>e.jsx("option",{value:a.name,children:a.label},`ff-rm-${a.name}`)))})]}),s.formField==="custom"&&e.jsx(I,{onChange:a=>R(a,t,l,n),label:r("Custom Value","bit-integrations"),className:"mr-2",type:"text",value:s.customValue,placeholder:r("Custom Value","bit-integrations"),formFields:i}),e.jsxs("select",{className:"btcd-paper-inp",disabled:t<b.length,name:"omniSendFormField",value:t<b?b[t].label||"":s.omniSendFormField||"",onChange:a=>w(a,t,l,n),children:[e.jsx("option",{value:"",children:r("Select Field","bit-integrations")}),t<b.length?e.jsx("option",{value:b[t].key,children:b[t].label},b[t].key):x.map(({key:a,label:d})=>e.jsx("option",{value:a,children:d},a))]})]}),t>=b.length&&e.jsxs(e.Fragment,{children:[e.jsx("button",{onClick:()=>f(t,l,n),className:"icn-btn sh-sm ml-2 mr-1",type:"button",children:"+"}),e.jsx("button",{onClick:()=>P(t,l,n),className:"icn-btn sh-sm ml-1",type:"button","aria-label":"btn",children:e.jsx("span",{className:"btcd-icn icn-trash-2"})})]})]})})}function B({omniSendConf:t,setOmniSendConf:i,formFields:s,loading:l,setLoading:n}){const[b,x]=j.useState({show:!1,action:()=>{}}),p=(c,a)=>{const d=u({},t);a==="tag"&&(c.target.checked?d.actions.tag=!0:delete d.actions.tag,x({show:a})),i(u({},d))},m=()=>{x({show:!1})},o=(c,a)=>{const d=u({},t);a==="selected_tags"&&c.length?d.actions.selected_tags=!0:a==="selected_tags"&&c.length<1&&delete d.actions.selected_tags,d[a]=c,i(u({},d))};return e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"pos-rel d-flx w-8",children:e.jsx($,{checked:(t==null?void 0:t.actions.tag)||!1,onChange:c=>p(c,"tag"),className:"wdt-200 mt-4 mr-2",value:"tags",title:r("Tags","bit-integrations"),subTitle:r("Add Custom Tags","bit-integrations")})}),e.jsxs(L,{className:"custom-conf-mdl",mainMdlCls:"o-v",btnClass:"blue",btnTxt:r("Ok","bit-integrations"),show:b.show==="tag",close:m,action:m,title:r("Add Custom Tags","bit-integrations"),children:[e.jsx("div",{className:"btcd-hr mt-2 mb-2"}),e.jsx("div",{className:"flx flx-between mt-2",children:e.jsx(F,{className:"msl-wrp-options",defaultValue:t==null?void 0:t.selected_tags,options:[],onChange:c=>o(c,"selected_tags"),customValue:!0})})]})]})}function K({formFields:t,handleInput:i,omniSendConf:s,setOmniSendConf:l,loading:n,setLoading:b,setSnackbar:x}){const p=j.useRef(!0),m=[{label:"Email",value:"email"},{label:"SMS",value:"sms"}],o=(c,a)=>{const d=c.search("email"),v=c.search("sms"),g=u({},s),h=g.omniSend_fields;c.length?(g.actions.channel=!0,d!==-1&&v!==-1?(h[0].required=!0,h[1].required=!0):d!==-1?(h[0].required=!0,h[1].required=!1):v!==-1?(h[1].required=!0,h[0].required=!1):(h[0].required=!1,h[1].required=!1)):(delete g.actions.channel,h[0].required=!1,h[1].required=!1),g[a]=c,l(u({},g))};return j.useEffect(()=>{if(p.current)p.current=!1;else{const c=u({},s),a=q(c);c.field_map=a,l(c)}},[s.channels]),e.jsxs(e.Fragment,{children:[e.jsx("br",{}),e.jsxs("div",{className:"flx",children:[e.jsx("b",{className:"wdt-200 d-in-b",children:r("Channels","bit-integrations")}),e.jsx(F,{className:"msl-wrp-options  w-5",defaultValue:s==null?void 0:s.channels,options:m==null?void 0:m.map(c=>({label:c.label,value:c.value})),onChange:c=>o(c,"channels"),customValue:!0})]}),e.jsx("br",{}),s.channels.search("email")!==-1&&e.jsxs("div",{className:"flx",children:[e.jsx("b",{className:"wdt-200 d-in-b",children:r("Email Status:","bit-integrations")}),e.jsxs("select",{onChange:i,name:"email_status",value:s.email_status,className:"btcd-paper-inp w-5",required:!0,children:[e.jsx("option",{value:"",children:r("Select Status","bit-integrations")}),e.jsx("option",{value:"subscribed",children:"Subscribed"}),e.jsx("option",{value:"unsubscribed",children:"Unsubscribed"}),e.jsx("option",{value:"nonSubscribed",children:"nonSubscribed"})]})]}),e.jsx("br",{}),s.channels.search("sms")!==-1&&e.jsxs("div",{className:"flx",children:[e.jsx("b",{className:"wdt-200 d-in-b",children:r("SMS Status:","bit-integrations")}),e.jsxs("select",{onChange:i,name:"sms_status",value:s.sms_status,className:"btcd-paper-inp w-5",required:!0,children:[e.jsx("option",{value:"",children:r("Select Status","bit-integrations")}),e.jsx("option",{value:"subscribed",children:"Subscribed"}),e.jsx("option",{value:"unsubscribed",children:"Unsubscribed"}),e.jsx("option",{value:"nonSubscribed",children:"nonSubscribed"})]})]}),(s.channels.search("email")!==-1||s.channels.search("sms")!==-1)&&e.jsxs(e.Fragment,{children:[e.jsx("br",{}),e.jsx("div",{className:"mt-5",children:e.jsx("b",{className:"wdt-100",children:r("Field Map","bit-integrations")})}),e.jsx("br",{}),n.field&&e.jsx(y,{style:{display:"flex",justifyContent:"center",alignItems:"center",height:100,transform:"scale(0.7)"}}),e.jsx("div",{className:"btcd-hr mt-1"}),e.jsxs("div",{className:"flx flx-around mt-2 mb-2 btcbi-field-map-label",children:[e.jsx("div",{className:"txt-dp",children:e.jsx("b",{children:r("Form Fields","bit-integrations")})}),e.jsx("div",{className:"txt-dp",children:e.jsx("b",{children:r("OmniSend Fields","bit-integrations")})})]}),s==null?void 0:s.field_map.map((c,a)=>e.jsx(U,{i:a,field:c,omniSendConf:s,formFields:t,setOmniSendConf:l,setSnackbar:x},`rp-m-${a+9}`)),e.jsx("div",{className:"txt-center btcbi-field-map-button mt-2",children:e.jsx("button",{onClick:()=>f(s.field_map.length,s,l),className:"icn-btn sh-sm",type:"button",children:"+"})}),e.jsx("br",{}),e.jsx("br",{}),e.jsx("div",{className:"mt-4",children:e.jsx("b",{className:"wdt-100",children:r("Actions","bit-integrations")})}),e.jsx("div",{className:"btcd-hr mt-1"}),e.jsx(B,{omniSendConf:s,setOmniSendConf:l,formFields:t,loading:n,setLoading:b})]})]})}export{K as O};
